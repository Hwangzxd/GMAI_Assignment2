tree("Root")
	repeat
		fallback
			sequence
				not Ammo_LessThan(3)
				tree("Attack")
			tree("Reload")
			tree("Roaming")
			tree("Idle")


tree("Idle")
	while
		sequence
			not HasEnemy
			not Acquire_Enemy
		repeat
			sequence
				random
					SetTarget_Angle(90.0)
					SetTarget_Angle(-90.0)
					SetTarget_Angle(135.0)
					SetTarget_Angle(-135.0)
				AimAt_Target
				WaitRandom(0.5, 2.0)


tree("Roaming")
	while
		sequence
			not HasEnemy
			not Acquire_Enemy
		repeat
			fallback
				sequence
					IsVisible_Treasure
					tree("GoToTreasure")
				sequence
					SetDestination_Waypoint
					SetTarget_Destination
					AimAt_Target
					MoveTo_Destination
					Wait(0.3)
					NextWaypoint


tree("Attack")
	fallback
		repeat
			sequence
				IsVisible_Enemy
				HasAmmo
				Stop
				Wait(0.5)
				SetTarget_Enemy
				AimAt_Target
				tree("Fire")
		sequence
			Clear_Enemy
			Fail


tree("Fire")
	sequence
		Wait(0.3)
		Fire


tree("Reload")
	while Ammo_LessThan(3)
		sequence
			not HasAmmo
			Stop
			Wait(2.0)
			Succeed


// New task to check for treasure and set destination
tree("GoToTreasure")
	sequence
		SetDestination_Treasure
		tree("ReturnToNest")


tree("ReturnToNest")
	sequence
		SetDestination_Nest
		tree("Idle")