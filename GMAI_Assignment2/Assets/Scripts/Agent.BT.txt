tree("Root")
	repeat
		fallback
			tree("GoToTreasure")
			tree("Reload")
			tree("Attack")
			random
				tree("Roaming")
				tree("Idle")


tree("Idle")
	while
		sequence
			not IsVisible_Treasure
			not HasEnemy
			not Acquire_Enemy
		repeat 2
			sequence
				random
					SetTarget_Angle(90.0)
					SetTarget_Angle(-90.0)
					SetTarget_Angle(135.0)
					SetTarget_Angle(-135.0)
				AimAt_Target
				Wait(2.0)


tree("Roaming")
	while 
		sequence
			not IsVisible_Treasure
			not IsVisible_Player
		repeat 2
			sequence
				SetDestination_Waypoint
				SetTarget_Destination
				AimAt_Target
				MoveTo_Destination
				Wait(0.3)
				NextWaypoint
		

tree("Attack")
	fallback
		repeat
			sequence
				IsVisible_Player
				HasAmmo
				Stop
				Wait(0.5)
				SetTarget_Enemy
				AimAt_Target
				tree("Fire")
		sequence
			Clear_Enemy
			Fail


tree("Fire")
	sequence
		Wait(0.3)
		Fire


tree("Reload")
	while Ammo_LessThan(3)
		sequence
			not HasAmmo
			Stop
			Wait(2.0)
			Succeed


tree("GoToTreasure")
	sequence
		IsVisible_Treasure
		SetDestination_Treasure
		PickUp
		tree("ReturnToNest")


tree("ReturnToNest")
	sequence
		SetDestination_Nest
		Drop
		tree("Idle")


tree("Chase")
	repeat
		sequence
			SetDestination_Enemy
			IsVisible_Player
			HasAmmo
			Stop
			Wait(0.5)
			AimAt_Target
			tree("Fire")


tree("ChaseEnemy")
	fallback
		while not IsVisible_Player
			parallel
				repeat
					sequence
                        HasAmmo
						Stop
						Wait(0.5)
						AimAt_Target
						tree("Fire")
				repeat
					sequence
						SetDestination_Enemy
						MoveTo_Destination